## 日志检测

## 1、文件结构

![image-20220508213904780](https://tva1.sinaimg.cn/large/e6c9d24ely1h21bss4qf7j20wa0kqjsp.jpg)

## 2、mian函数结构



![image-20220508213705240](https://tva1.sinaimg.cn/large/e6c9d24ely1h21bqonq1tj20g908l3yv.jpg)

## 3、main.py架构

![image-20220508214609699](https://tva1.sinaimg.cn/large/e6c9d24ely1h21c04g88nj20rb0dqab2.jpg)

## 4、代码解析

##### 1）规则读取

![image-20220508214707661](https://tva1.sinaimg.cn/large/e6c9d24ely1h21c14lf9rj20e00cldgj.jpg)

##### 2）日志读取

![image-20220508214728319](https://tva1.sinaimg.cn/large/e6c9d24ely1h21c1kij0tj20cr05sgm0.jpg)

##### 3）日志解析

![image-20220508214745094](https://tva1.sinaimg.cn/large/e6c9d24ely1h21c1rua9uj20cv06rq3k.jpg)

##### 4）规则匹配

![image-20220508214802800](https://tva1.sinaimg.cn/large/e6c9d24ely1h21c235q6xj20el05owem.jpg)

##### 5）日志检测

![image-20220508214833998](https://tva1.sinaimg.cn/large/e6c9d24ely1h21c2mf57uj20qc09rq40.jpg)

##### 6）循环运行

![image-20220508215132261](https://tva1.sinaimg.cn/large/e6c9d24ely1h21c5rib0pj20n90d2q4b.jpg)

## 5、效果展示

![image-20220508215225210](https://tva1.sinaimg.cn/large/e6c9d24ely1h21c6n38wnj21lp0hl7aw.jpg)

![image-20220508215234229](https://tva1.sinaimg.cn/large/e6c9d24ely1h21c6su5dnj21b70jan57.jpg)